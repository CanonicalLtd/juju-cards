"use strict";function init(){var a=document.querySelectorAll("."+targetClass);Array.from(a).forEach(function(a){var e=a.dataset.id;null!==e?getData(a,e):console.warn("Found card with no ID")}),updateHead()}function getData(a,e){var t=apiAddress+e+"/meta/any"+apiIncludes;get(t).then(function(e){console.log(e),e.Message?reportError(a,e.Message):detectType(a,e)},function(a){console.warn(a)})}function detectType(a,e){"bundle"===e.Meta["id-series"].Series?renderBundle(a,e):renderCharm(a,e)}function renderBundle(a,e){var t=e.Meta["id-name"].Name,r=e.Id,c=e.Meta["id-series"].Series,s=e.Meta.id.Revision,d="https://launchpad.net/~"+e.Meta["extra-info"]["bzr-owner"],n=e.Meta["extra-info"]["bzr-owner"],l="https://jujucharms.com/"+t+"/"+c+"/"+s,i="https://demo.jujucharms.com/?deploy-target="+getImageID(r),o='<div class="juju-card__container bundle-card">'+('<a href="'+l+'" class="bundle-card__link">View details</a>')+'<header class="bundle-card__header"><div class="bundle-card__image-container">'+('<object wmode="transparent" width="100%" class="bundle-card__bundle-image" type="image/svg+xml" data="https://api.jujucharms.com/charmstore/v4/bundle/'+t+"-"+s+'/diagram.svg"></object>')+'</div></header><main class="bundle-card__main"><div class="bundle-card__meta">'+('<h1 class="bundle-card__title">'+t+"</h1>")+('<p class="bundle-card__by">by <a href="'+d+'">'+n+"</a></h1>")+'</div><ul class="bundle-card__actions"><li class="bundle-card__actions-item--details"><label class="bundle-card__actions-label" for="cli-deploy">Deploy with the CLI:</label>'+('<input class="bundle-card__actions-field" readonly="readonly" value="juju deploy '+r+'" id="cli-deploy">')+'</li><li class="bundle-card__actions-item--demo">'+('<a href="'+i+'" class="bundle-card__add-button--primary">Deploy with Juju</a>')+'</li></ul></main><footer class="bundle-card__footer"><a href="http://jujucharms.com"><img src="https://jujucharms.com/static/img/logos/logo.svg" alt="" class="bundle-card__footer-logo" /></a><p class="bundle-card__footer-note">© 2015 <a href="http://www.canonical.com">Canonical Ltd</a>.</p></footer></div>';a.innerHTML=o,a.classList.add("juju-card--rendered"),a.classList.add(getWidthClass(a))}function renderCharm(a,e){var t=e.Meta["id-name"].Name,r=e.Id,c="https://api.jujucharms.com/v4/"+getImageID(r)+"/icon.svg",s=(prettyPrintNumber(e.Meta.stats.ArchiveDownloadCount),e.Meta["id-series"].Series),d=e.Meta.id.Revision,n=e.Meta["extra-info"]["bzr-owner"],l="https://launchpad.net/~"+e.Meta["extra-info"]["bzr-owner"],i="https://jujucharms.com/"+t+"/"+s+"/"+d,o="https://demo.jujucharms.com/?deploy-target="+r,u='<div class="juju-card__container charm-card">'+('<a href="'+i+'" class="charm-card__link">View details</a>')+'<header class="charm-card__header">'+('<img src="'+c+'" alt="'+t+'" class="charm-card__image" />')+('<h1 class="charm-card__title">'+t+"</h1>")+'<ul class="charm-card__meta">'+('<li class="charm-card__meta-item--by">by <a href="'+l+'">'+n+"</a></li>")+('<li class="charm-card__meta-item--series">'+s+"</li>")+'</ul></header><main class="charm-card__main"><ul class="charm-card__actions"><li class="charm-card__actions-item--details"><label class="charm-card__actions-label" for="cli-deploy">Deploy with the CLI:</label>'+('<input class="charm-card__actions-field" readonly="readonly" value="juju deploy '+r+'" id="cli-deploy">')+'</li><li class="charm-card__actions-item--demo">'+('<a href="'+o+'" class="charm-card__add-button--primary">Deploy with Juju</a>')+'</li></ul></main><footer class="charm-card__footer"><a href="http://jujucharms.com"><img src="https://jujucharms.com/static/img/logos/logo.svg" alt="" class="charm-card__footer-logo" /></a><p class="charm-card__footer-note">© 2015 <a href="http://www.canonical.com">Canonical Ltd</a>.</p></footer></div>';a.innerHTML=u,a.classList.add("juju-card--rendered"),a.classList.add(getWidthClass(a))}function updateHead(){var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",a.href="scss/styles.min.css",a.media="all",document.getElementsByTagName("head")[0].appendChild(a);var e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href="https://fonts.googleapis.com/css?family=Ubuntu+Mono|Ubuntu:300",document.getElementsByTagName("head")[0].appendChild(e)}function getWidthClass(a){var e=a.offsetWidth,t="juju-card--small";return e>301&&(t="juju-card--medium"),e>626&&(t="juju-card--large"),t}function reportError(a,e){var t='<div class="juju-card__error">'+('<p class="juju-card__error-message">'+e+"</p>")+"</div>";a.innerHTML=t,a.classList.add("juju-card--rendered")}var targetClass="juju-card",apiAddress="https://api.jujucharms.com/charmstore/v4/",apiIncludes="?include=id-name&include=id&include=stats&include=id-series&include=extra-info&include=promulgated";document.addEventListener("DOMContentLoaded",function(a){init()});var prettyPrintNumber=function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},getImageID=function(a){return a.toString().replace("cs:","")},get=function(a){return new Promise(function(e,t){fetch(a).then(function(a){return a.json()}).then(function(a){return e(a)})["catch"](function(a){return t(Error(data.statusText))})})};